pluginManagement {
    repositories {
        gradlePluginPortal()
        maven {
            name = "Maven for PR #300" // https://github.com/neoforged/ModDevGradle/pull/300
            url = uri("https://prmaven.neoforged.net/ModDevGradle/pr300")
            content {
                includeModule("net.neoforged.moddev.legacyforge", "net.neoforged.moddev.legacyforge.gradle.plugin")
                includeModule("net.neoforged.moddev.legacyforge.repositories", "net.neoforged.moddev.legacyforge.repositories.gradle.plugin")
                includeModule("net.neoforged.moddev", "net.neoforged.moddev.gradle.plugin")
                includeModule("net.neoforged.moddev.repositories", "net.neoforged.moddev.repositories.gradle.plugin")
                includeModule("net.neoforged", "moddev-gradle")
            }
        }
    }
    includeBuild '../neoform-gradle-plugin'
}

plugins {
    id 'net.neoforged.neoform'
}

dependencyResolutionManagement {
    repositories {
        maven {
            name = "Maven for PR #91" // https://github.com/neoforged/NeoFormRuntime/pull/93
            url = uri("https://prmaven.neoforged.net/NeoFormRuntime/pr93")
            content {
                includeModule("net.neoforged", "neoform-runtime")
            }
        }
    }
}

neoForm {
    minecraftVersion = '25w45a_unobfuscated'
    minecraftLauncherManifestUrl = 'https://shartte.github.io/Minecraft1.21.11UnobfuscatedMeta/manifest.json'
    minecraftDependencies = [
            'net.neoforged:minecraft-dependencies:25w45a'
    ]

    additionalCompileDependencies = [
            'net.neoforged:mergetool:2.0.7:api',
            'com.google.code.findbugs:jsr305:3.0.2',
            'org.jetbrains:annotations:26.0.2-1',
            // In the Minecraft libraries list, this is MacOS X specific since it only contains runtime dependencies
            // But the MacOS X specific code referencing this will be compiled on all platforms.
            'ca.weblite:java-objc-bridge:1.1'
    ]

    javaVersion = 21

    preProcessJar {
        version = 'net.neoforged.installertools:installertools:4.0.25-pr-30-patchformat:fatjar'
        repositoryUrl = 'https://prmaven.neoforged.net/InstallerTools/pr30'
        args = [
                '--task',
                'PROCESS_MINECRAFT_JAR',
                '--input',
                '{downloadClientOutput}',
                '--input',
                '{downloadServerOutput}',
                '--output',
                '{output}'
        ]
    }

    decompiler {
        version = 'net.neoforged:vineflower-plugins:0.1.5:vfbundle'
        jvmArgs = [
                '-Xmx4g'
        ]
        args = [
                '--decompile-inner',
                '--remove-bridge',
                '--decompile-generics',
                '--ascii-strings',
                '--remove-synthetic',
                '--include-classpath',
                '--ignore-invalid-bytecode',
                '--bytecode-source-mapping',
                '--dump-code-lines',
                '--indent-string=    ',
                '--log-level=WARN',
                '-cfg={listLibrariesOutput}',
                '{preProcessJarOutput}',
                '{output}'
        ]
    }
}
