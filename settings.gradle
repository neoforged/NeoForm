pluginManagement {
    includeBuild './plugin'
}

plugins {
    id 'net.neoforged.neoform'
}

neoForm {
    minecraftVersion = '1.21.11-pre2_unobfuscated'
    minecraftLauncherManifestUrl = 'https://shartte.github.io/Minecraft1.21.11UnobfuscatedMeta/manifest.json'
    minecraftDependencies = [
            'net.neoforged:minecraft-dependencies:1.21.11-pre2'
    ]

    additionalCompileDependencies = [
            'net.neoforged:mergetool:2.0.7:api',
            'com.google.code.findbugs:jsr305:3.0.2',
            'org.jetbrains:annotations:26.0.2-1',
            // In the Minecraft libraries list, this is MacOS X specific since it only contains runtime dependencies
            // But the MacOS X specific code referencing this will be compiled on all platforms.
            'ca.weblite:java-objc-bridge:1.1'
    ]

    javaVersion = 21
    testJavaVersions = [25] // Additional Java versions to test with

    preProcessJar {
        version = 'net.neoforged.installertools:installertools:4.0.6:fatjar'
        args = ['--task', 'PROCESS_MINECRAFT_JAR', '--input', '{downloadClientOutput}', '--input', '{downloadServerOutput}', '--output', '{output}']
    }

    decompiler {
        version = 'net.neoforged:vineflower-plugins:0.1.5:vfbundle'
        jvmArgs = ['-Xmx4g']
        args = [
                '--decompile-inner',
                '--remove-bridge',
                '--decompile-generics',
                '--ascii-strings',
                '--remove-synthetic',
                '--include-classpath',
                '--ignore-invalid-bytecode',
                '--bytecode-source-mapping',
                '--dump-code-lines',
                '--indent-string=    ',
                '--log-level=WARN',
                '-cfg={listLibrariesOutput}',
                '{preProcessJarOutput}',
                '{output}'
        ]
    }
}
