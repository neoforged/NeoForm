pluginManagement {
    includeBuild '../neoform-gradle-plugin'
}

plugins {
    id 'net.neoforged.neoform'
}

neoForm {
    minecraftVersion = '25w45a_unobfuscated'
    minecraftAssetsVersion = '25w45a'
    minecraftVersionManifestUrl = 'https://piston-data.mojang.com/v1/objects/de334d80d9ddc5abb94c611b8ad10f9125c4c421/25w45a_unobfuscated.zip'
    minecraftDependencies = [
            'net.neoforged:minecraft-dependencies:25w45a'
    ]

    additionalCompileDependencies = [
            'net.neoforged:mergetool:2.0.7:api',
            'com.google.code.findbugs:jsr305:3.0.2',
            'org.jetbrains:annotations:26.0.2-1'
    ]

    javaVersion = "21"

    preProcessJar {
        mainClass = 'net.neoforged.installertools.ConsoleTool'
        classpath = [
                'org.vineflower:vineflower:1.11.2'
        ]
        args = [
                '--task',
                'PROCESS_MINECRAFT_JAR',
                '--input',
                '${clientJar}',
                '--input',
                '${serverJar}',
                '--output',
                '${output}'
        ]
    }

    decompiler {
        mainClass = 'org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler'
        classpath = [
                'org.vineflower:vineflower:1.11.2',
                'net.neoforged:vineflower-plugins:0.1.2'
        ]
        jvmArgs = [
                '-Xmx4g'
        ]
        args = [
                '--decompile-inner',
                '--remove-bridge',
                '--decompile-generics',
                '--ascii-strings',
                '--remove-synthetic',
                '--include-classpath',
                '--ignore-invalid-bytecode',
                '--bytecode-source-mapping',
                '--dump-code-lines',
                '--indent-string=    '
        ]
    }
}
